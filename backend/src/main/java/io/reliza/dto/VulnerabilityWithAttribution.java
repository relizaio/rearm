package io.reliza.dto;

import java.util.List;

/**
 * Enhanced vulnerability detail with component attribution.
 * Shows which components/releases resolved, introduced, or still have this vulnerability.
 */
public record VulnerabilityWithAttribution(
    // Core vulnerability data
    String vulnId,
    String severity,
    String purl,
    
    // Attribution lists - which releases contributed to this vulnerability's lifecycle
    List<ComponentAttribution> resolvedIn,      // Releases that resolved this vulnerability
    List<ComponentAttribution> appearedIn,      // Releases where this vulnerability appeared
    List<ComponentAttribution> presentIn,       // Latest releases that currently have this vulnerability
    
    // Org-wide state flags
    boolean isNetResolved,   // True if resolved in all components (no longer in org)
    boolean isNetAppeared,   // True if newly appeared in org (wasn't anywhere before)
    boolean isStillPresent,  // True if exists in at least one component's latest release
    
    // Optional org-level context (only populated for multi-component org-level queries)
    OrgLevelContext orgContext
) {}
