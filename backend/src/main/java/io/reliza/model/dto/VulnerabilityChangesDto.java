/**
* Copyright Reliza Incorporated. 2019 - 2025. Licensed under the terms of AGPL-3.0-only.
*/

package io.reliza.model.dto;

import java.util.List;
import java.util.Set;
import java.util.UUID;

import com.fasterxml.jackson.annotation.JsonIgnoreProperties;

import io.reliza.model.AnalysisState;
import io.reliza.model.dto.ReleaseMetricsDto.VulnerabilitySeverity;

/**
 * DTOs for tracking vulnerability changes between releases
 */
@JsonIgnoreProperties(ignoreUnknown = true)
public class VulnerabilityChangesDto {

	public record VulnerabilityChangesRecord(
		List<VulnerabilityChangeRecord> appeared,
		List<VulnerabilityChangeRecord> resolved,
		List<VulnerabilityChangeRecord> severityChanged,
		VulnerabilityChangesSummary summary
	) {}

	public record VulnerabilityChangeRecord(
		String findingId,
		List<String> aliases,
		VulnerabilitySeverity severity,
		VulnerabilitySeverity previousSeverity,
		String affectedComponent,
		AnalysisState analysisState,
		Set<UUID> sources
	) {}

	public record VulnerabilityChangesSummary(
		int totalAppeared,
		int totalResolved,
		int totalSeverityChanged,
		int netChange
	) {}
}
